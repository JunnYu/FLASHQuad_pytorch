# FLASHQuad_pytorch
pytorch implement of FLASHQuad

# Describtion
个人实现`pytorch`版本的[《Transformer Quality in Linear Time》](https://arxiv.org/abs/2202.10447)

# Usage
```python
from flash import FLASHQuadConfig, FLASHQuadModel
import torch
config = FLASHQuadConfig()
model = FLASHQuadModel(config)
model.eval()
input_ids = torch.randint(0,12000,(4,128))
with torch.no_grad():
    outputs = model(input_ids=input_ids, output_attentions=True, output_hidden_states=True)
    print(outputs)
# BaseModelOutput(last_hidden_state=tensor([[[-9.4036e-01,  2.7427e-01, -1.1174e-01,  ...,  2.1995e-01,
#            6.8563e-01,  3.7119e-01],
#          [ 1.4871e-01,  7.9682e-01,  6.6237e-01,  ...,  1.5242e+00,
#            4.3464e-01,  4.5139e-01],
#          [ 8.4712e-01,  1.1916e+00,  1.4192e+00,  ...,  5.9129e-01,
#            1.6662e-01,  1.2947e+00],
#          ...,
#          [-1.4811e+00, -4.6251e-01, -1.4264e+00,  ...,  6.2525e-01,
#           -2.0381e-01,  3.5314e-01],
#          [ 5.8889e-02,  3.1540e-01,  5.3227e-01,  ...,  9.8981e-01,
#            1.9056e-01, -1.0363e-01],
#          [ 7.3799e-01, -7.2342e-01,  9.3099e-01,  ...,  1.3865e+00,
#            2.7682e-02, -4.0529e-01]],

#         [[-1.2761e+00,  1.0622e-01,  1.6675e-01,  ...,  6.4745e-01,
#            8.1417e-01,  1.8487e-01],
#          [ 1.3764e+00,  1.9084e-01,  8.4460e-01,  ...,  1.2662e+00,
#           -1.0687e-01,  4.4796e-01],
#          [ 5.0415e-01,  1.1916e+00,  8.9216e-01,  ...,  9.3314e-01,
#           -1.4971e-01,  3.5086e-01],
#          ...,
#          [-1.5334e+00,  5.2134e-01, -6.1524e-01,  ...,  2.1776e-01,
#            8.9071e-01,  2.4238e-01],
#          [ 8.1833e-02, -3.0472e-01, -2.3848e-01,  ...,  2.8812e-01,
#            8.0858e-01, -6.6519e-01],
#          [-2.3373e-01, -6.0103e-01, -3.6428e-01,  ...,  2.4339e-01,
#            9.5541e-02,  5.1453e-01]],

#         [[-1.9778e+00,  8.3909e-02,  1.0512e-01,  ...,  8.1101e-01,
#           -5.6207e-02,  2.2087e-01],
#          [-5.7366e-04,  3.5103e-01,  4.3759e-01,  ...,  7.0966e-01,
#           -2.4418e-01, -2.6368e-01],
#          [ 5.6346e-01,  1.1321e+00,  8.4332e-01,  ...,  2.6250e-01,
#            3.9772e-02,  1.2804e+00],
#          ...,
#          [-2.7273e-01,  1.9569e-01,  4.5514e-01,  ...,  5.2621e-01,
#            1.7374e-01,  3.7357e-01],
#          [ 3.2217e-01, -3.6218e-01,  6.6083e-01,  ...,  7.6413e-01,
#            7.0839e-01,  7.0626e-01],
#          [ 1.6915e-01, -6.3726e-01,  1.0565e+00,  ...,  5.9521e-01,
#           -1.1999e-01,  9.4385e-02]],

#         [[-3.7354e-01, -9.3200e-02, -1.0634e+00,  ...,  8.2995e-01,
#            5.5959e-01,  7.1173e-01],
#          [ 2.2329e-01,  1.1134e+00,  9.2142e-01,  ...,  8.3274e-01,
#           0.0000e+00, 0.0000e+00],
#          [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 2.9886e-06,
#           5.0118e-04, 0.0000e+00],
#          [7.0109e-07, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
#           2.9887e-06, 5.0104e-04]]])))
```

# Tips:
不怎么确定实现的对不对，如果代码有错误的话，请帮我指出来，谢谢~